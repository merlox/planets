<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Generative arts</title>
	</head>
	<body>
		<script src="two.js"></script>
        <script src="https://two.js.org/third-party/physics.js"></script>

		<script>
			let two = new Two({
				fullscreen: true,
			}).appendTo(document.body)

			let mass = 100
			let radius = two.height / 5
			let strength = 0.0925
			let drag = 0.1

			let background = two.makeGroup()
			let foreground = two.makeGroup()

			let physics = new Physics()
			let points = []
            let points2 = []
            let eyesPoints = []
			let i = 0
            let pointAmount = 10

			for (i = 0; i < pointAmount; i++) {
				let ax = radius * Math.cos(i / pointAmount * Math.PI * 2) + (Math.random() * 10)
				let ay = radius * Math.sin(i / pointAmount * Math.PI * 2) + (Math.random() * 10)

				let particle = physics.makeParticle(
					mass,
					ax,
					ay
				)

				// particle.shape = two.makeCircle(
				// 	particle.position.x,
				// 	particle.position.y,
				// 	2
				// )
				// particle.shape.noStroke().fill = '#fff'
				particle.position = new Two.Vector(particle.position.x, particle.position.y)

                // foreground.add(particle.shape)
				points.push(particle.position)
			}
            for (i = 0; i < pointAmount; i++) {
				let ax = radius * Math.cos(i / pointAmount * Math.PI * 2) + (Math.random() * 10)
				let ay = radius * Math.sin(i / pointAmount * Math.PI * 2) + (Math.random() * 10)
				let particle = physics.makeParticle(
					mass,
					ax,
					ay
				)

				particle.position = new Two.Vector(particle.position.x, particle.position.y)
				points2.push(particle.position)
			}


            const generate = (pointAmount, radius, mass, color, variance, isRight) => {
			    const physics = new Physics()
                for (i = 0; i < pointAmount; i++) {
                    let ax = radius / 4 * Math.cos(i / pointAmount * Math.PI * 2) + (Math.random() * variance)
                    let ay = radius / 4 * Math.sin(i / pointAmount * Math.PI * 2) + (Math.random() * variance)
                    let particle = physics.makeParticle(
                        mass,
                        ax,
                        ay
                    )
                    let offset = isRight ? 60 : -60
                    particle.position = new Two.Vector(particle.position.x + offset, particle.position.y - 60)
                    eyesPoints.push(particle.position)
                }
			    const path = new Two.Path(eyesPoints, true, true)
                path.fill = color
                path.linewidth = 3
                return path
            }

			let outer = new Two.Path(points, true, true)
			let outer2 = new Two.Path(points2, true, true)
			let outer3 = new Two.Path(eyesPoints, true, true)
			let color = getRandomColor()
			// outer.stroke = color.toString()
			// outer2.stroke = color.toString()
			outer.fill = color.toString(0.8)
			outer2.fill = 'rgba(0, 0, 0, 0)'
			outer3.fill = color.toString(0.8)
			outer.linewidth = 5
			outer2.linewidth = 5
            outer3.linewidth = 5
            document.querySelector('html').style.backgroundColor = color.toString(0.2)

			background.add(outer)
			background.add(outer2)
			background.add(generate(10, two.height / 10, 100, 'rgba(255, 255, 255, 0.1)', 4, true))
			background.add(generate(10, two.height / 10, 100, 'rgba(255, 255, 255, 0.1)', 4, false))

			// let inner = new Two.Path(points, true, true)
			// inner.noStroke()
			// inner.fill = getRandomColor().toString()
			// inner.scale = 1.25

			// background.add(inner)

			// two.renderer.domElement.style.background =
			// 	'url(' + generateGrid() + ') center center'

			resize()

			two
				.bind('resize', resize)
				.bind('update', function () {
					physics.update()
				})
				.play()

			function resize() {
				background.translation.set(two.width / 2, two.height / 2)
				foreground.translation.copy(background.translation)
			}

			function getRandomColor() {
				let color = {
					r: Math.floor(Math.random() * 255),
					g: Math.floor(Math.random() * 255),
					b: Math.floor(Math.random() * 255),
					toString: function (a) {
						if (a) {
							return (
								'rgba(' +
								color.r +
								',' +
								color.g +
								',' +
								color.b +
								',' +
								a +
								')'
							)
						}
						return 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')'
					},
				}
				return color
			}

			function generateGrid() {
				let two = new Two({
					type: Two.Types.canvas,
					width: 16,
					height: 16,
					ratio: 2,
				})

				let width = two.width / 2
				let height = two.height / 2

				let background = two.makeRectangle(
					two.width / 2,
					two.height / 2,
					two.width,
					two.height
				)
				background.noStroke().fill = '#efefef'

				let c = two.makeCircle(two.width / 2, two.height / 2, 0.5)
				c.noStroke().fill = '#999'

				two.update()

				return two.renderer.domElement.toDataURL('image/png')
			}
		</script>
	</body>
</html>
